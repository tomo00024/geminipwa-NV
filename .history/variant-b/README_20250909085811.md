---
### `README.md` の修正案

# Gemini PWA (拡張版: 画像URLプレースホルダー変換機能搭載)

このプロジェクトは、[titan823/geminipwa](https://github.com/titan823/geminipwa) をフォークし、**画像URLプレースホルダー変換機能**を独自に追加したバージョンです。オリジナルの Gemini PWA クライアントの豊富な機能に加え、AIによるURL生成の不安定さを解消し、確実な画像表示を目指して改良したものです。
---

### 🌟 新機能: 画像 URL プレースホルダー変換機能

この機能は、AI が出力する特定の文字列（プレースホルダー）を、PWA 側で指定したベース URL に自動的に変換し、動的ながらも確実な画像表示を実現します。

#### 概要

- **目的**: AI は完全な URL を正確に生成するのが苦手で、しばしば形式ミス（ハイフンやスラッシュの抜け・重複など）を起こします。この機能は、AI のタスクを「キーワードの選択」に単純化し、URL の組み立てという技術的な処理を PWA 側が担うことで、エラーをなくし安定した画像表示を可能にします。
- **有効化**: 設定画面内の「画像 URL 変換設定」セクションにあるチェックボックスをオンにすることで、この機能を有効にできます。
- **動作**: この機能が有効な場合、AI が応答内で `![alt text]({{画像URL}}/...)` のようにプレースホルダー `{{画像URL}}` を使用すると、PWA が画面に表示する直前に、設定された「ベース URL」に自動的に置き換えます。

---

### 利用方法

**当 PWA はブラウザから以下の URL にて利用可能です：**
(https://tomo00024.github.io/geminipwa-NV/variant-b/)

1.  このフォークを PWA としてインストールします（お使いのブラウザの機能を使用）。
2.  設定画面にアクセスし、ご自身の AI サービス API キー（例: Gemini API キー）を設定してください。
3.  新しく追加された「**画像 URL 変換設定**」セクションで、機能を有効にし、ご自身で用意した画像の**ベース URL**を入力します。
4.  AI への指示（プロンプト）を修正し、`{{画像URL}}` を使った形式で画像を出力するように伝えます。
5.  チャットを開始し、AI が生成する応答に基づいて画像が正しく表示されることを確認します。

---

#### 設定方法

1.  **設定画面を開く:** アプリの「設定」画面に移動します。
2.  **機能を有効化:** 「画像 URL 変換設定」セクションの「AI 応答内の画像 URL プレースホルダーを変換する」にチェックを入れます。
3.  **ベース URL を入力:** 表示された入力欄に、ご自身がホスティングしている画像の起点となる URL を入力します。
    - 例: `https://dashing-fenglisu-4c8446.netlify.app`

#### プロンプトの設定例

AI に、以下のようなプロンプトを与えてください。AI は、この指示に従って `{}` の部分を文脈に応じて選択し、応答を生成します。

```
# 画像出力ルール
画像を出力する際は、必ず次の形式を使用してください。
`![alt text]({{画像URL}}/{キャラクター名}/{服装}/{表情}.avif)`

- `{{画像URL}}` の部分は、絶対に書き換えず、そのまま出力してください。
- `{キャラクター名}`, `{服装}`, `{表情}` の部分は、後述のリストから、そのシーンの文脈に最も適したものを選択してください。

# 選択可能なキーワードリスト
- キャラクター名: ゆず, アオイ
- 服装: 制服, 私服, パジャマ
- 表情: 笑顔, 怒り, 悲しみ
```

#### 動作例

- **AI の出力:**
  `![笑顔のゆず]({{画像URL}}/ゆず/私服/笑顔.avif)`
- **PWA による変換後の URL:**
  `https://dashing-fenglisu-4c8446.netlify.app/ゆず/私服/笑顔.avif`
- **チャット画面での表示:**
  上記の URL の画像が正しく表示されます。

#### 注意事項

- この機能は、AI がプロンプトの指示に正しく従い、`{{画像URL}}` プレースホルダーを含む文字列を出力することが前提です。
- 設定する画像 URL は、あらかじめご自身で用意し、Web サーバー等でホスティングしておく必要があります。このツール自体が画像を生成するわけではありません。

---

### 重要事項・免責事項

- このフォークは、個人的な利用のために作成されたものであり、オリジナルの `geminipwa` プロジェクトとは独立しています。
- 本プロジェクトは**サポートを提供しません**。また、予告なく仕様変更や更新が終了する可能性があります。
- 初めてデバイスで使用する際は、必ず必要最低限の機能からテストしてください。
- スマートフォンブラウザでの使用を想定しており、アプリ化や Windows 上でのローカル使用はデバッグされていません。
- 問題が発生した場合は、PWA のキャッシュ削除を試みてください。
- セッション履歴やプロンプトなどのデータは永続的に保存されることを意図しておらず、自動バックアップ機能もありません。重要なデータはご自身でバックアップしてください。
